<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.oracle.munguFactory.mapper.hej.output">

	<select id="outputTotal" resultType="int">
		SELECT COUNT(*) FROM output
	</select>

	<!-- 생산실적 목록 -->
	<select id="outputList" resultType="Output" parameterType="Output">
      SELECT  *   FROM
        (SELECT  *   FROM 
         (SELECT 
                 @ROWNUM:=@ROWNUM + 1 AS ROWNUM, 
                              prod_no
                            ,item_no
                            ,emp_no
                            ,factory_no
                            ,item_name
                            ,finish_date
                            ,prod_amount
                           ,poor_quantity
                           ,yield
             FROM
                 output P, (SELECT @ROWNUM:=0) TMP
             ORDER BY prod_no DESC) SUB
                 ORDER BY SUB.ROWNUM ASC)the
                  <![CDATA[where ROWNUM >#{start} and ROWNUM <=#{end}]]>
	</select>
	
	<!-- 공장 목록 -->
	<select id="factoryList" resultType="Factory">
		SELECT * FROM factory
	</select>
	
	<!-- 사원 목록 -->
	<select id="empList" resultType="Emp">
		SELECT * FROM emp
	</select>
	
	<!-- 생산실적 등록 -->
	<insert id="insertOutput" parameterType="Output">
		INSERT INTO output(factory_no, item_no, item_name, emp_no, finish_date, prod_amount, poor_quantity, yield)
		VALUES(#{factory_no}, #{item_no}, #{item_name}, #{emp_no}, #{finish_date}, #{prod_amount}, #{poor_quantity},  (#{poor_quantity}/#{prod_amount})*100)
	</insert>
	
	<!-- 생산실적 상세 정보 -->	
	<select id="outputDetail" parameterType="int" resultType="Output">
		SELECT * FROM output WHERE prod_no = #{prod_no}	
	</select>
	

<!--     <update id="tkEmpUpdate" parameterType="Emp">
		 UPDATE emp SET ename=#{ename}, job=#{job}, mgr=#{mgr},
					    sal=#{sal}, 
					    hiredate=#{hiredate}, 
		                <if test="#{comm}!=null"> 	comm=#{comm},    </if>
		                deptno=#{deptno} 
		 WHERE  empno=#{empno}
   </update>	
	 -->
</mapper>